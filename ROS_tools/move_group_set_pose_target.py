'''
# 彭，防止遗忘：本文件用于可视化给定的关节组下机器人运动的动态轨迹，可以循环播放
'''

# import rospy
# from sensor_msgs.msg import JointState

# rospy.init_node("ur10e_joint_publisher")

# joint_pub = rospy.Publisher("/joint_states", JointState, queue_size=10)
# rate = rospy.Rate(10)  # 10 Hz

# while not rospy.is_shutdown():
#     joint_state = JointState()
#     joint_state.header.stamp = rospy.Time.now()
#     joint_state.name = [
#         "shoulder_pan_joint", "shoulder_lift_joint", "elbow_joint",
#         "wrist_1_joint", "wrist_2_joint", "wrist_3_joint"
#     ]
#     joint_state.position = [-2.8045, -0.4411,  1.3730, -2.5027,  1.5708, -1.9079]  # 各关节目标角度（单位：弧度）
#     joint_pub.publish(joint_state)
#     rate.sleep()

import rospy
from sensor_msgs.msg import JointState
from time import sleep

# 初始化 ROS 节点
rospy.init_node("ur10e_joint_trajectory_publisher")

# 关节发布器
joint_pub = rospy.Publisher("/joint_states", JointState, queue_size=10)
rate = rospy.Rate(10)  # 10 Hz


# 这一组有突变
trajectory = [[-2.8044607639312744, -0.7237036228179932, 1.4274972677230835, -2.274590015411377, -1.570796251296997, -1.2336643934249878], [-2.828897476196289, -0.8501287698745728, 1.6716077327728271, -2.392275333404541, -1.570796251296997, -1.2581011056900024], [-2.7811977863311768, -0.8664481043815613, 1.8303120136260986, -2.5346603393554688, -1.570796251296997, -1.2104014158248901], [-2.8164288997650146, -1.0266233682632446, 2.0049779415130615, -2.5491509437561035, -1.570796251296997, -1.245632529258728], [-2.7330639362335205, -0.9972267150878906, 2.106332302093506, -2.6799020767211914, -1.570796251296997, -1.1622675657272339], [-2.613776683807373, -1.0110620260238647, 2.17514967918396, -2.734884023666382, -1.570796251296997, -1.0429803133010864], [-2.5198822021484375, -1.1509038209915161, 2.238696336746216, -2.6585888862609863, -1.570796251296997, -0.9490858316421509], [-2.437755823135376, -1.008500099182129, 2.273609161376953, -2.8359055519104004, -1.570796251296997, -0.8669594526290894], [-2.445835828781128, -0.8424066305160522, 2.344747304916382, -3.073137044906616, -1.570796251296997, -0.8750394582748413], [-2.297332763671875, 1.4265313148498535, -2.3245432376861572, -0.6727845668792725, -1.570796251296997, -0.7265363931655884], [-2.248800039291382, 1.6211307048797607, -2.427910327911377, -0.7640166282653809, -1.570796251296997, -0.6780036687850952], [-2.096693515777588, 1.7145096063613892, -2.3593716621398926, -0.9259343147277832, -1.570796251296997, -0.5258971452713013], [-2.0643887519836426, 1.9373000860214233, -2.4358627796173096, -1.0722336769104004, -1.570796251296997, -0.49359238147735596], [-2.036970376968384, 2.112975835800171, -2.3597748279571533, -1.3239972591400146, -1.570796251296997, -0.46617400646209717], [-1.9463753700256348, 2.2475178241729736, -2.494121789932251, -1.3241922855377197, -1.570796251296997, -0.37557899951934814], [-1.745347499847412, 2.249809980392456, -2.35750412940979, -1.463102102279663, -1.5707963705062866, -0.1745511293411255], [-1.5009562969207764, -0.1222543716430664, 1.9562137126922607, -0.26316308975219727, 1.5707963705062866, -3.0717525482177734], [-1.2619316577911377, -0.2029918134212494, 1.8948578834533691, -0.12106978893280029, 1.5707963705062866, -2.8327279090881348], [-1.0874663591384888, -0.32162368297576904, 1.9497201442718506, -0.05730020999908447, 1.5707963705062866, -2.6582627296447754], [-0.8679193258285522, -0.32956254482269287, 1.9443724155426025, -0.0440136194229126, 1.5707963705062866, -2.438715696334839], [-0.7288264036178589, -0.3757314383983612, 1.812069296836853, 0.13445842266082764, 1.5707963705062866, -2.2996227741241455], [-0.6669744253158569, -0.3972576856613159, 1.6499485969543457, 0.3181053400039673, 1.5707963705062866, -2.2377707958221436], [-0.7014703154563904, -0.4156942367553711, 1.508130431175232, 0.47836005687713623, 1.5707963705062866, -2.2722668647766113], [-0.6258590221405029, -0.4998256266117096, 1.4738836288452148, 0.596738338470459, 1.5707963705062866, -2.1966552734375], [-0.5549852252006531, -0.624850332736969, 1.5561069250106812, 0.6395395994186401, 1.5707963705062866, -2.125781536102295], [-0.5429902672767639, -0.6668006777763367, 1.4308624267578125, 0.806734561920166, 1.5707963705062866, -2.1137866973876953], [-0.45962485671043396, -0.7024115324020386, 1.3384637832641602, 0.9347438812255859, 1.5707963705062866, -2.030421257019043], [-0.5138595700263977, -0.6898633241653442, 1.1766142845153809, 1.08404541015625, 1.5707963705062866, -2.084656000137329], [-0.44110459089279175, -0.7168706655502319, 1.07921302318573, 1.2084537744522095, 1.5707963705062866, -2.0119009017944336], [-0.33364570140838623, -0.6829197406768799, 0.9647835493087769, 1.2889324426651, 1.5707963705062866, -1.9044420719146729], [-0.27581995725631714, -0.6838918328285217, 0.8151601552963257, 1.4395278692245483, 1.5707963705062866, -1.846616268157959], [-0.2738335430622101, -0.49222779273986816, 0.4111419916152954, 1.6518820524215698, 1.5707963705062866, -1.8446298837661743]]

# 这一组还行
# trajectory = [[-2.8044607639312744, -0.7237036228179932, 1.4274972677230835, -2.274590015411377, -1.570796251296997, -1.2336643934249878], [-2.8051042556762695, -0.88749098777771, 1.601846694946289, -2.285151958465576, -1.570796251296997, -1.234307885169983], [-2.753021478652954, -1.0204143524169922, 1.7220267057418823, -2.2724087238311768, -1.570796251296997, -1.1822251081466675], [-2.670274257659912, -1.0398997068405151, 1.8378249406814575, -2.3687214851379395, -1.570796251296997, -1.0994778871536255], [-2.7383410930633545, -1.032612919807434, 1.9951183795928955, -2.533301830291748, -1.570796251296997, -1.1675447225570679], [-2.7831873893737793, -1.1137276887893677, 2.195707321166992, -2.652776002883911, -1.570796251296997, -1.2123910188674927], [-2.744933843612671, -1.206371545791626, 2.3631463050842285, -2.7275710105895996, -1.570796251296997, -1.1741374731063843], [-2.683047294616699, -1.1205662488937378, 2.484813690185547, -2.9350438117980957, -1.570796251296997, -1.1122509241104126], [-2.5278711318969727, -1.1558983325958252, 2.554568290710449, -2.969466209411621, -1.570796251296997, -0.957074761390686], [-2.469872236251831, 1.4131304025650024, -2.5029656887054443, -0.4809610843658447, -1.570796251296997, -0.8990758657455444], [-2.2735939025878906, -0.9416950941085815, 2.4569666385650635, -3.0860679149627686, -1.570796251296997, -0.702797532081604], [-2.1266748905181885, -1.092401146888733, 2.4872989654541016, -2.9656941890716553, -1.570796251296997, -0.5558785200119019], [-1.933610439300537, -1.0937193632125854, 2.4603874683380127, -2.937464475631714, -1.570796251296997, -0.3628140687942505], [-1.77035653591156, -1.0938817262649536, 2.336498260498047, -2.81341290473938, -1.570796251296997, -0.19956016540527344], [-1.625807285308838, -1.0377984046936035, 2.2060279846191406, -2.7390260696411133, -1.5707963705062866, -0.05501091480255127], [-1.5573112964630127, -0.8522327542304993, 1.5831618309020996, 0.839867115020752, 1.5707963705062866, -3.1281075477600098], [-1.43686842918396, -0.8604294061660767, 1.4916539192199707, 0.9395718574523926, 1.5707963705062866, -3.007664680480957], [-1.4378607273101807, -0.8954946398735046, 1.3610832691192627, 1.1052076816558838, 1.5707963705062866, -3.0086569786071777], [-1.4495444297790527, -0.9683672189712524, 1.2955358028411865, 1.2436277866363525, 1.5707963705062866, -3.020340919494629], [-1.399603247642517, -0.8866642117500305, 1.0288668870925903, 1.4285935163497925, 1.5707963705062866, -2.9703996181488037], [-1.319964051246643, -0.9104665517807007, 0.9414348602294922, 1.539827823638916, 1.5707963705062866, -2.8907604217529297], [-1.2036654949188232, -0.8525703549385071, 0.8089376091957092, 1.614428997039795, 1.5707963705062866, -2.7744617462158203], [-1.097729206085205, -0.8730473518371582, 0.7868940234184265, 1.656949520111084, 1.5707963705062866, -2.6685256958007812], [-0.994391143321991, -0.7256757616996765, 0.5557480454444885, 1.7407240867614746, 1.5707963705062866, -2.565187454223633], [-0.8890065550804138, -0.7690766453742981, 0.6314465403556824, 1.7084262371063232, 1.5707963705062866, -2.4598028659820557], [-0.7824643850326538, -0.7067726850509644, 0.5685136318206787, 1.7090551853179932, 1.5707963705062866, -2.3532607555389404], [-0.6887720227241516, -0.7393730282783508, 0.5545855760574341, 1.755583643913269, 1.5707963705062866, -2.259568452835083], [-0.58488929271698, -0.6890547871589661, 0.4007403552532196, 1.8591105937957764, 1.5707963705062866, -2.1556856632232666], [-0.4928972125053406, -0.754744291305542, 0.4541926383972168, 1.8713479042053223, 1.5707963705062866, -2.0636935234069824], [-0.407471239566803, -0.7996334433555603, 0.6511244773864746, 1.7193052768707275, 1.5707963705062866, -1.9782676696777344], [-0.34142911434173584, -0.9024084806442261, 0.9382636547088623, 1.5349409580230713, 1.5707963705062866, -1.9122254848480225], [-0.2738335430622101, -0.49222779273986816, 0.4111419916152954, 1.6518820524215698, 1.5707963705062866, -1.8446298837661743]]
# 这一组有突变2
# trajectory =[[-2.8044607639312744, -0.7237036228179932, 1.4274972677230835, -2.274590015411377, -1.570796251296997, -1.2336643934249878], [-2.7964792251586914, -0.8594425916671753, 1.4835758209228516, -2.194929599761963, -1.570796251296997, -1.2256828546524048], [-2.846261739730835, -0.9904617667198181, 1.5453344583511353, -2.125669002532959, -1.570796251296997, -1.2754653692245483], [-2.785658359527588, -1.110650658607483, 1.6736003160476685, -2.1337461471557617, -1.570796251296997, -1.2148619890213013], [-2.778376579284668, -1.2238117456436157, 1.8868240118026733, -2.2338085174560547, -1.570796251296997, -1.2075802087783813], [-2.737394332885742, -1.3801506757736206, 1.9789780378341675, -2.169623851776123, -1.570796251296997, -1.1665979623794556], [-2.695432186126709, -1.5430089235305786, 2.0618948936462402, -2.0896823406219482, -1.570796251296997, -1.1246358156204224], [-2.690772771835327, -1.6278358697891235, 2.2527685165405273, -2.1957290172576904, -1.570796251296997, -1.1199764013290405], [-2.7847886085510254, -1.7889479398727417, 2.4283359050750732, -2.210184335708618, -1.570796251296997, -1.2139922380447388], [-2.68638277053833, -1.8769606351852417, 2.561046600341797, -2.254882335662842, -1.570796251296997, -1.1155864000320435], [-2.4831767082214355, -1.7254678010940552, 2.60520339012146, -2.4505319595336914, -1.570796251296997, -0.9123803377151489], [-2.4734551906585693, -1.9079757928848267, 2.7611403465270996, -2.4239609241485596, -1.570796251296997, -0.9026588201522827], [-2.4609084129333496, -2.295164108276367, 2.864314079284668, -2.139946460723877, -1.570796251296997, -0.890112042427063], [-2.0865180492401123, -1.816489815711975, 2.875227451324463, -2.6295340061187744, -1.570796251296997, -0.5157216787338257], [-2.060297727584839, -1.7839876413345337, 3.0447001457214355, -2.8315088748931885, -1.570796251296997, -0.48950135707855225], [-1.6901487112045288, 1.2180988788604736, -2.9444477558135986, 0.15555262565612793, -1.5707963705062866, -0.11935234069824219], [-1.5180778503417969, -1.0743540525436401, 2.3127903938293457, 0.33235979080200195, 1.5707963705062866, -3.088874340057373], [-1.3294354677200317, -1.1831640005111694, 2.241222620010376, 0.512737512588501, 1.5707963705062866, -2.9002318382263184], [-1.2362885475158691, -1.22416090965271, 2.082500457763672, 0.7124567031860352, 1.5707963705062866, -2.8070850372314453], [-1.0958759784698486, -1.271539568901062, 1.9724974632263184, 0.8698382377624512, 1.5707963705062866, -2.6666722297668457], [-0.9490983486175537, -1.3113168478012085, 1.8820886611938477, 1.0000243186950684, 1.5707963705062866, -2.519894599914551], [-0.7650051116943359, -1.2461271286010742, 1.7990270853042603, 1.017896294593811, 1.5707963705062866, -2.335801601409912], [-0.6051288843154907, -1.1648104190826416, 1.7591912746429443, 0.9764153957366943, 1.5707963705062866, -2.1759252548217773], [-0.453338623046875, -1.1245548725128174, 1.63961923122406, 1.0557318925857544, 1.5707963705062866, -2.024135112762451], [-0.3235867917537689, -1.0137349367141724, 1.5282196998596191, 1.0563116073608398, 1.5707963705062866, -1.894383192062378], [-0.2686063349246979, -0.849313497543335, 1.3317667245864868, 1.0883430242538452, 1.5707963705062866, -1.839402675628662], [-0.2185908704996109, -0.7257972955703735, 1.0360642671585083, 1.2605293989181519, 1.5707963705062866, -1.7893872261047363], [-0.2738335430622101, -0.49222779273986816, 0.4111419916152954, 1.6518820524215698, 1.5707963705062866, -1.8446298837661743]]

# 9障碍物有突变
# trajectory =[[-2.8044607639312744, -0.7237036228179932, 1.4274972677230835, -2.274590015411377, -1.570796251296997, -1.2336643934249878], [-2.7510018348693848, -0.8512817621231079, 1.5584708452224731, -2.2779855728149414, -1.570796251296997, -1.1802054643630981], [-2.768749713897705, -0.8924686312675476, 1.7675482034683228, -2.445875883102417, -1.570796251296997, -1.1979533433914185], [-2.6814985275268555, -0.9860056638717651, 1.8412543535232544, -2.4260449409484863, -1.570796251296997, -1.1107021570205688], [-2.725684642791748, -1.061157464981079, 2.0477795600891113, -2.5574183464050293, -1.570796251296997, -1.1548882722854614], [-2.8125524520874023, -1.1158933639526367, 2.229721784591675, -2.684624671936035, -1.570796251296997, -1.2417560815811157], [-2.7383227348327637, -1.050658941268921, 2.338733673095703, -2.8588709831237793, -1.570796251296997, -1.167526364326477], [-2.6398043632507324, -0.9916459321975708, 2.438504695892334, -3.01765513420105, -1.570796251296997, -1.0690079927444458], [-2.6416494846343994, 1.3769972324371338, -2.612755298614502, -0.3350381851196289, -1.570796251296997, -1.0708531141281128], [-2.7328429222106934, 1.214794397354126, -2.779799699783325, -0.0057909488677978516, -1.570796251296997, -1.1620465517044067], [-2.482790946960449, -1.3179534673690796, 2.7850167751312256, -3.0378596782684326, -1.570796251296997, -0.9119945764541626], [-2.372556209564209, -1.7216566801071167, 2.7937958240509033, -2.6429355144500732, -1.570796251296997, -0.8017598390579224], [-2.0800137519836426, -1.7826241254806519, 2.7389473915100098, -2.5271196365356445, -1.570796251296997, -0.509217381477356], [-1.8313179016113281, -1.6034194231033325, 2.7705907821655273, -2.7379677295684814, -1.570796251296997, -0.2605215311050415], [-1.671475887298584, -1.911537766456604, 2.7338004112243652, -2.393059015274048, -1.5707963705062866, -0.10067951679229736], [-1.5891436338424683, -2.2461116313934326, 2.801762819290161, -2.1264476776123047, -1.5707963705062866, -0.01834726333618164], [-1.190531611442566, -1.5285420417785645, 2.3997578620910645, 0.6995804309844971, 1.5707963705062866, -2.7613279819488525], [-0.9169149398803711, -1.38637113571167, 2.398592710494995, 0.5585746765136719, 1.5707963705062866, -2.487711191177368], [-0.7826535105705261, -1.3655803203582764, 2.20417857170105, 0.7321979999542236, 1.5707963705062866, -2.353449821472168], [-0.7941755652427673, -1.3014211654663086, 2.0141000747680664, 0.8581173419952393, 1.5707963705062866, -2.364971876144409], [-0.8241193890571594, -1.163074254989624, 1.8406355381011963, 0.8932349681854248, 1.5707963705062866, -2.394915819168091], [-0.7859019041061401, -1.0547888278961182, 1.6097513437271118, 1.0158337354660034, 1.5707963705062866, -2.3566982746124268], [-0.7171061635017395, -0.8952988386154175, 1.430556297302246, 1.035538673400879, 1.5707963705062866, -2.287902593612671], [-0.7221689224243164, -0.7298121452331543, 1.1928772926330566, 1.1077311038970947, 1.5707963705062866, -2.2929654121398926], [-0.6061244010925293, -0.6917119026184082, 1.1403050422668457, 1.1222031116485596, 1.5707963705062866, -2.1769208908081055], [-0.2738335430622101, -0.49222779273986816, 0.4111419916152954, 1.6518820524215698, 1.5707963705062866, -1.8446298837661743]]
# 8障碍物
# trajectory =[[-2.8044607639312744, -0.7237036228179932, 1.4274972677230835, -2.274590015411377, -1.570796251296997, -1.2336643934249878], [-2.7692525386810303, -0.7449065446853638, 1.603985071182251, -2.429874897003174, -1.570796251296997, -1.1984561681747437], [-2.715235471725464, -0.8765506744384766, 1.7025177478790283, -2.396763324737549, -1.570796251296997, -1.1444391012191772], [-2.7338860034942627, -1.015690565109253, 1.9106898307800293, -2.4657955169677734, -1.570796251296997, -1.163089632987976], [-2.6446828842163086, -1.1175763607025146, 1.9943385124206543, -2.4475584030151367, -1.570796251296997, -1.073886513710022], [-2.645479679107666, -1.1278382539749146, 2.1660399436950684, -2.6089980602264404, -1.570796251296997, -1.0746833086013794], [-2.724534034729004, -1.2495249509811401, 2.349789619445801, -2.6710610389709473, -1.570796251296997, -1.1537376642227173], [-2.678910493850708, -1.2704273462295532, 2.509664535522461, -2.8100335597991943, -1.570796251296997, -1.1081141233444214], [-2.721662998199463, -1.1592793464660645, 2.67280912399292, -3.0843262672424316, -1.570796251296997, -1.1508666276931763], [-2.622164249420166, -1.451830506324768, 2.7388360500335693, -2.857801914215088, -1.570796251296997, -1.0513678789138794], [-2.3768081665039062, -1.5084458589553833, 2.632596254348755, -2.694946765899658, -1.570796251296997, -0.8060117959976196], [-2.2152624130249023, -1.600476622581482, 2.502077579498291, -2.4723973274230957, -1.570796251296997, -0.6444660425186157], [-2.0120065212249756, -1.6199547052383423, 2.5001277923583984, -2.4509694576263428, -1.570796251296997, -0.44121015071868896], [-1.812498927116394, -1.6044092178344727, 2.4046740531921387, -2.371061325073242, -1.570796251296997, -0.24170255661010742], [-1.6587562561035156, -1.6852303743362427, 2.4657649993896484, -2.3513309955596924, -1.5707963705062866, -0.087959885597229], [-1.5364184379577637, -1.3971068859100342, 1.9819566011428833, 0.985946536064148, 1.5707963705062866, -3.10721492767334], [-1.4334163665771484, -1.3883683681488037, 1.8106842041015625, 1.1484804153442383, 1.5707963705062866, -3.0042128562927246], [-1.3443940877914429, -1.4412561655044556, 1.710567593574524, 1.3014849424362183, 1.5707963705062866, -2.9151904582977295], [-1.2557481527328491, -1.2897710800170898, 1.48935866355896, 1.371208667755127, 1.5707963705062866, -2.8265445232391357], [-1.1212081909179688, -1.1696974039077759, 1.3401453495025635, 1.400348424911499, 1.5707963705062866, -2.692004680633545], [-1.016538381576538, -1.154207468032837, 1.1963739395141602, 1.5286297798156738, 1.5707963705062866, -2.587334632873535], [-0.9489443898200989, -1.2596708536148071, 1.2490358352661133, 1.5814313888549805, 1.5707963705062866, -2.5197408199310303], [-0.8303435444831848, -1.2803210020065308, 1.1782927513122559, 1.6728243827819824, 1.5707963705062866, -2.401139974594116], [-0.6935830116271973, -1.222996711730957, 1.013869047164917, 1.779923915863037, 1.5707963705062866, -2.2643795013427734], [-0.6162031292915344, -1.297181487083435, 1.2445266246795654, 1.6234509944915771, 1.5707963705062866, -2.1869993209838867], [-0.5333535671234131, -1.3695718050003052, 1.448102593421936, 1.4922655820846558, 1.5707963705062866, -2.10414981842041], [-0.3951576352119446, -1.4220762252807617, 1.4510595798492432, 1.5418128967285156, 1.5707963705062866, -1.965954065322876], [-0.24715960025787354, -1.3599052429199219, 1.4745826721191406, 1.4561188220977783, 1.5707963705062866, -1.8179559707641602], [-0.18088877201080322, -1.1930731534957886, 1.3073651790618896, 1.4565043449401855, 1.5707963705062866, -1.7516851425170898], [-0.2738335430622101, -0.49222779273986816, 0.4111419916152954, 1.6518820524215698, 1.5707963705062866, -1.8446298837661743]]
# 7障碍物
# trajectory =[[-2.8044607639312744, -0.7237036228179932, 1.4274972677230835, -2.274590015411377, -1.570796251296997, -1.2336643934249878], [-2.811406135559082, -0.8384422659873962, 1.6718575954437256, -2.4042117595672607, -1.570796251296997, -1.2406097650527954], [-2.7358901500701904, -0.9235199093818665, 1.8017604351043701, -2.4490368366241455, -1.570796251296997, -1.1650937795639038], [-2.647541046142578, -0.8787503242492676, 1.860982060432434, -2.553028106689453, -1.570796251296997, -1.0767446756362915], [-2.6625735759735107, -0.9607160091400146, 2.068153142929077, -2.6782336235046387, -1.570796251296997, -1.0917772054672241], [-2.5944314002990723, -0.9418401718139648, 2.195019245147705, -2.8239755630493164, -1.570796251296997, -1.0236350297927856], [-2.5986413955688477, -1.0848952531814575, 2.370434522628784, -2.8563356399536133, -1.570796251296997, -1.027845025062561], [-2.6276278495788574, -1.3269354104995728, 2.466367244720459, -2.710228204727173, -1.570796251296997, -1.0568314790725708], [-2.6244709491729736, -1.400024175643921, 2.6418769359588623, -2.8126492500305176, -1.570796251296997, -1.053674578666687], [-2.8041274547576904, -1.6954822540283203, 2.6744956970214844, -2.5498099327087402, -1.570796251296997, -1.2333310842514038], [-2.890352964401245, -2.1027777194976807, 2.750389337539673, -2.2184081077575684, -1.570796251296997, -1.3195565938949585], [-2.8242383003234863, -2.487008571624756, 2.789595603942871, -1.8733834028244019, -1.570796251296997, -1.2534419298171997], [-2.4948997497558594, -2.6093878746032715, 2.8073208332061768, -1.768729329109192, -1.570796251296997, -0.9241033792495728], [-2.3978023529052734, -2.873490810394287, 2.699840545654297, -1.3971461057662964, -1.570796251296997, -0.8270059823989868], [-1.7034251689910889, -2.498032331466675, 2.6727473735809326, -1.7455114126205444, -1.5707963705062866, -0.13262879848480225], [-1.4901034832000732, -1.5774354934692383, 2.426875591278076, 0.7213561534881592, 1.5707963705062866, -3.0608997344970703], [-1.3232572078704834, -1.3458689451217651, 2.2828545570373535, 0.6338105201721191, 1.5707963705062866, -2.8940534591674805], [-1.1462222337722778, -1.2381359338760376, 2.0930683612823486, 0.7158639430999756, 1.5707963705062866, -2.7170186042785645], [-1.0019704103469849, -1.0990536212921143, 2.069777250289917, 0.6000726222991943, 1.5707963705062866, -2.5727667808532715], [-0.8459367752075195, -0.9764636158943176, 2.032278299331665, 0.5149815082550049, 1.5707963705062866, -2.4167332649230957], [-0.67835533618927, -0.8753236532211304, 1.9776611328125, 0.4684586524963379, 1.5707963705062866, -2.2491517066955566], [-0.5831447243690491, -0.7188815474510193, 1.82405686378479, 0.4656209945678711, 1.5707963705062866, -2.1539411544799805], [-0.4211670160293579, -0.6765573620796204, 1.7567015886306763, 0.4906519651412964, 1.5707963705062866, -1.9919633865356445], [-0.38639843463897705, -0.6916171312332153, 1.5921945571899414, 0.6702189445495605, 1.5707963705062866, -1.9571948051452637], [-0.42247143387794495, -0.5770342350006104, 1.3669450283050537, 0.7808854579925537, 1.5707963705062866, -1.9932677745819092], [-0.488247275352478, -0.47262513637542725, 1.1601500511169434, 0.8832712173461914, 1.5707963705062866, -2.0590436458587646], [-0.4626377820968628, -0.573954164981842, 1.166130542755127, 0.9786198139190674, 1.5707963705062866, -2.0334341526031494], [-0.47411102056503296, -0.6561222076416016, 1.1301441192626953, 1.0967743396759033, 1.5707963705062866, -2.044907331466675], [-0.2738335430622101, -0.49222779273986816, 0.4111419916152954, 1.6518820524215698, 1.5707963705062866, -1.8446298837661743]]
# 6障碍物
# trajectory =[[-2.8044607639312744, -0.7237036228179932, 1.4274972677230835, -2.274590015411377, -1.570796251296997, -1.2336643934249878], [-2.7974863052368164, -0.850570797920227, 1.46140456199646, -2.1816301345825195, -1.570796251296997, -1.2266899347305298], [-2.716754913330078, -0.9062396883964539, 1.4425199031829834, -2.107076644897461, -1.570796251296997, -1.1459585428237915], [-2.6708784103393555, -1.0408172607421875, 1.559746265411377, -2.0897254943847656, -1.570796251296997, -1.1000820398330688], [-2.601269245147705, -1.142632007598877, 1.6958378553390503, -2.12400221824646, -1.570796251296997, -1.0304728746414185], [-2.6383790969848633, -1.3082138299942017, 1.8089326620101929, -2.0715150833129883, -1.570796251296997, -1.0675827264785767], [-2.565392255783081, -1.4300521612167358, 1.9072394371032715, -2.0479836463928223, -1.570796251296997, -0.9945958852767944], [-2.457357406616211, -1.506063461303711, 1.901254653930664, -1.9659875631332397, -1.570796251296997, -0.8865610361099243], [-2.369021415710449, -1.6007589101791382, 1.883138656616211, -1.8531761169433594, -1.570796251296997, -0.7982250452041626], [-2.2238929271698, -1.5561695098876953, 1.8910300731658936, -1.9056569337844849, -1.570796251296997, -0.6530965566635132], [-2.0934338569641113, -1.5756932497024536, 1.9592516422271729, -1.9543547630310059, -1.570796251296997, -0.5226374864578247], [-1.9721711874008179, -1.4507511854171753, 1.9080696105957031, -2.0281147956848145, -1.570796251296997, -0.40137481689453125], [-1.8691680431365967, -1.543332815170288, 1.9311275482177734, -1.958591103553772, -1.570796251296997, -0.29837167263031006], [-1.790578842163086, -1.6282761096954346, 2.0783579349517822, -2.020878314971924, -1.570796251296997, -0.21978247165679932], [-1.661945104598999, -1.593493103981018, 2.156930446624756, -2.1342337131500244, -1.5707963705062866, -0.0911487340927124], [-1.5432419776916504, -1.1508417129516602, 1.5262770652770996, 1.1953608989715576, 1.5707963705062866, -3.1140384674072266], [-1.4418903589248657, -1.241923213005066, 1.567624807357788, 1.2450945377349854, 1.5707963705062866, -3.0126867294311523], [-1.3023746013641357, -1.290692687034607, 1.5929319858551025, 1.268556833267212, 1.5707963705062866, -2.873170852661133], [-1.1536965370178223, -1.203115701675415, 1.5383481979370117, 1.2355637550354004, 1.5707963705062866, -2.7244930267333984], [-1.0139641761779785, -1.2135990858078003, 1.5984612703323364, 1.1859339475631714, 1.5707963705062866, -2.5847606658935547], [-0.8665384650230408, -1.1274843215942383, 1.500651240348816, 1.1976293325424194, 1.5707963705062866, -2.4373347759246826], [-0.8102147579193115, -1.0315663814544678, 1.5276377201080322, 1.0747249126434326, 1.5707963705062866, -2.3810110092163086], [-0.6938822865486145, -1.039254903793335, 1.6161869764328003, 0.9938641786575317, 1.5707963705062866, -2.264678716659546], [-0.2738335430622101, -0.49222779273986816, 0.4111419916152954, 1.6518820524215698, 1.5707963705062866, -1.8446298837661743]]
# 5障碍物
# trajectory =[[-2.8044607639312744, -0.7237036228179932, 1.4274972677230835, -2.274590015411377, -1.570796251296997, -1.2336643934249878], [-2.83463191986084, -0.7580462098121643, 1.6345540285110474, -2.4473042488098145, -1.570796251296997, -1.2638355493545532], [-2.756649971008301, -0.7493905425071716, 1.7314623594284058, -2.552868127822876, -1.570796251296997, -1.1858536005020142], [-2.818967342376709, -0.8210490345954895, 1.9343304634094238, -2.684077739715576, -1.570796251296997, -1.2481709718704224], [-2.7200887203216553, -0.8818448781967163, 2.0300612449645996, -2.71901273727417, -1.570796251296997, -1.1492923498153687], [-2.6827547550201416, -1.0550248622894287, 2.1239423751831055, -2.639713764190674, -1.570796251296997, -1.111958384513855], [-2.729264736175537, -1.242809772491455, 2.2650413513183594, -2.5930280685424805, -1.570796251296997, -1.1584683656692505], [-2.7989845275878906, -1.4579538106918335, 2.375650405883789, -2.488492965698242, -1.570796251296997, -1.228188157081604], [-2.7331113815307617, -1.6658676862716675, 2.4130184650421143, -2.3179471492767334, -1.570796251296997, -1.162315011024475], [-2.5430684089660645, -1.6980533599853516, 2.3706982135772705, -2.243441104888916, -1.570796251296997, -0.9722720384597778], [-2.3624074459075928, -1.72278892993927, 2.3012681007385254, -2.149275541305542, -1.570796251296997, -0.7916110754013062], [-2.3084452152252197, -1.9215675592422485, 2.365276336669922, -2.01450514793396, -1.570796251296997, -0.7376488447189331], [-2.387559413909912, -2.0577962398529053, 2.2672691345214844, -1.7802692651748657, -1.570796251296997, -0.8167630434036255], [-2.2732224464416504, -2.2131848335266113, 2.3068666458129883, -1.6644781827926636, -1.570796251296997, -0.7024260759353638], [-2.371263027191162, -2.4588019847869873, 2.327791213989258, -1.4397855997085571, -1.570796251296997, -0.8004666566848755], [-2.0760092735290527, -2.4938876628875732, 2.27225661277771, -1.3491653203964233, -1.570796251296997, -0.5052129030227661], [-1.6405432224273682, -2.3796796798706055, 2.203474521636963, -1.394591212272644, -1.5707963705062866, -0.06974685192108154], [-1.308548092842102, -1.9235843420028687, 2.0373480319976807, 1.4570324420928955, 1.5707963705062866, -2.8793444633483887], [-1.0065795183181763, -1.7465288639068604, 1.8899067640304565, 1.4274183511734009, 1.5707963705062866, -2.577375888824463], [-0.7758360505104065, -1.742601752281189, 1.795074462890625, 1.5183234214782715, 1.5707963705062866, -2.346632480621338], [-0.5255405902862549, -1.7060672044754028, 1.8324310779571533, 1.4444324970245361, 1.5707963705062866, -2.096336841583252], [-0.28851839900016785, -1.691113829612732, 1.8779714107513428, 1.3839385509490967, 1.5707963705062866, -1.8593147993087769], [-0.09421855211257935, -1.6749320030212402, 1.7466641664505005, 1.499064326286316, 1.5707963705062866, -1.6650149822235107], [0.02977028489112854, -1.5222148895263672, 1.694819450378418, 1.3981919288635254, 1.5707963705062866, -1.5410261154174805], [0.15336868166923523, -1.3820617198944092, 1.6370666027069092, 1.315791368484497, 1.5707963705062866, -1.417427659034729], [0.09099116921424866, -1.2852017879486084, 1.432456612586975, 1.4235414266586304, 1.5707963705062866, -1.4798052310943604], [0.14662890136241913, -1.1136572360992432, 1.1872209310531616, 1.4972325563430786, 1.5707963705062866, -1.424167513847351], [0.13159999251365662, -0.9687818884849548, 1.0725631713867188, 1.467015027999878, 1.5707963705062866, -1.4391963481903076], [0.11558090150356293, -0.8251023292541504, 0.9563764333724976, 1.439522385597229, 1.5707963705062866, -1.4552154541015625], [0.07341206073760986, -0.6530905365943909, 0.7238460183143616, 1.5000410079956055, 1.5707963705062866, -1.4973843097686768], [-0.000490829348564148, -0.6917451024055481, 0.9219769835472107, 1.340564489364624, 1.5707963705062866, -1.5712871551513672], [-0.09812265634536743, -0.8028887510299683, 1.0522514581680298, 1.321433663368225, 1.5707963705062866, -1.6689190864562988], [-0.2738335430622101, -0.49222779273986816, 0.4111419916152954, 1.6518820524215698, 1.5707963705062866, -1.8446298837661743]]

# 以下是有ik但是有碰撞的，看看筛选掉了啥东西？
# 3-4连杆碰撞
# trajectory =[[0.3440885841846466, 0.05174235254526138, 1.147074818611145, 0.3719792366027832, 1.5707963705062866, -1.2267078161239624], [0.3622743487358093, -0.1025790199637413, 1.4111992120742798, 0.26217615604400635, 1.5707963705062866, -1.208522081375122], [0.49777844548225403, -0.06783001124858856, 1.4192147254943848, 0.21941161155700684, 1.5707963705062866, -1.073017954826355], [0.6126588582992554, -0.15824951231479645, 1.5571099519729614, 0.17193591594696045, 1.5707963705062866, -0.9581375122070312], [0.7644274830818176, -0.16402438282966614, 1.6037753820419312, 0.13104534149169922, 1.5707963705062866, -0.806368887424469], [0.8991553783416748, -0.07602883875370026, 1.550723910331726, 0.09610128402709961, 1.5707963705062866, -0.6716409921646118], [0.9402295351028442, -0.17395244538784027, 1.762293815612793, -0.017544984817504883, 1.5707963705062866, -0.6305668354034424], [1.0769972801208496, -0.291467547416687, 1.7796919345855713, 0.08257198333740234, 1.5707963705062866, -0.493799090385437], [1.1754066944122314, -0.3259839415550232, 1.9241068363189697, -0.027326583862304688, 1.5707963705062866, -0.3953896760940552], [1.308793306350708, -0.2754859924316406, 1.989065408706665, -0.1427830457687378, 1.5707963705062866, -0.2620030641555786], [1.4977012872695923, -0.30117684602737427, 2.0704431533813477, -0.198469877243042, 1.5707963705062866, -0.07309508323669434], [1.6694320440292358, -0.24355648458003998, 2.122292995452881, -0.30794012546539307, 1.5707963705062866, 0.09863567352294922], [1.8587937355041504, -0.3755117654800415, 2.223682165145874, -0.2773740291595459, 1.570796251296997, 0.28799736499786377], [1.9951248168945312, -0.5727800130844116, 2.249213218688965, -0.1056368350982666, 1.570796251296997, 0.42432844638824463], [2.032331943511963, -0.7479185461997986, 2.3932437896728516, -0.07452893257141113, 1.570796251296997, 0.46153557300567627], [1.9792091846466064, -0.9798729419708252, 2.4116828441619873, 0.13898634910583496, 1.570796251296997, 0.4084128141403198], [1.979355812072754, -1.1957502365112305, 2.3795602321624756, 0.38698649406433105, 1.570796251296997, 0.4085594415664673], [2.2035224437713623, -1.1339937448501587, 2.201420545578003, 0.5033695697784424, 1.570796251296997, 0.6327260732650757], [2.043255090713501, -1.1214340925216675, 1.9366695880889893, 0.7555608749389648, 1.570796251296997, 0.47245872020721436]]
# 直接和基座碰撞
# trajectory = [[0.3440885841846466, 0.05174235254526138, 1.147074818611145, 0.3719792366027832, 1.5707963705062866, -1.2267078161239624], [0.33888816833496094, -0.1084841936826706, 1.2984166145324707, 0.38086390495300293, 1.5707963705062866, -1.2319082021713257], [0.3716900944709778, -0.2584519386291504, 1.518848180770874, 0.310400128364563, 1.5707963705062866, -1.199106216430664], [0.3779717683792114, -0.3400026559829712, 1.454679012298584, 0.45612001419067383, 1.5707963705062866, -1.1928246021270752], [0.4954603910446167, -0.39977511763572693, 1.4436509609222412, 0.5269205570220947, 1.5707963705062866, -1.07533597946167], [0.4297546148300171, -0.46963492035865784, 1.402544379234314, 0.6378868818283081, 1.5707963705062866, -1.1410417556762695], [0.462441623210907, -0.5968409776687622, 1.4479739665985107, 0.7196633815765381, 1.5707963705062866, -1.1083548069000244], [0.5713762044906616, -0.5996198654174805, 1.3406834602355957, 0.8297328948974609, 1.5707963705062866, -0.9994202256202698], [0.6395099759101868, -0.7241842746734619, 1.4916361570358276, 0.8033443689346313, 1.5707963705062866, -0.9312863945960999], [0.7350417375564575, -0.7724632620811462, 1.431261420249939, 0.9119981527328491, 1.5707963705062866, -0.8357546329498291], [0.7157003879547119, -0.9357646703720093, 1.637153148651123, 0.8694078922271729, 1.5707963705062866, -0.8550959825515747], [0.7959152460098267, -1.0371545553207397, 1.642526388168335, 0.9654245376586914, 1.5707963705062866, -0.77488112449646], [0.9289328455924988, -1.0861541032791138, 1.656738042831421, 1.0002124309539795, 1.5707963705062866, -0.6418635249137878], [0.986758828163147, -1.224568247795105, 1.791335940361023, 1.0040286779403687, 1.5707963705062866, -0.5840375423431396], [1.0384836196899414, -1.3740789890289307, 1.9053843021392822, 1.0394909381866455, 1.5707963705062866, -0.5323127508163452], [1.2197418212890625, -1.3472765684127808, 1.7978535890579224, 1.120219349861145, 1.5707963705062866, -0.3510545492172241], [1.3883041143417358, -1.2542248964309692, 1.737587332725525, 1.087433934211731, 1.5707963705062866, -0.18249225616455078], [1.4764866828918457, -1.325225830078125, 1.6740432977676392, 1.221979022026062, 1.5707963705062866, -0.09430968761444092], [1.5819530487060547, -1.3328384160995483, 1.805142879486084, 1.098491907119751, 1.5707963705062866, 0.011156678199768066], [1.7483744621276855, -1.244863510131836, 1.762710452079773, 1.0529495477676392, 1.5707963705062866, 0.17757809162139893], [2.043255090713501, -1.1214340925216675, 1.9366695880889893, 0.7555608749389648, 1.570796251296997, 0.47245872020721436]]
# 直接和基座碰撞2
# trajectory = [[0.3440885841846466, 0.05174235254526138, 1.147074818611145, 0.3719792366027832, 1.5707963705062866, -1.2267078161239624], [0.4281986951828003, -0.07466170191764832, 1.3361659049987793, 0.309292197227478, 1.5707963705062866, -1.1425976753234863], [0.5344063639640808, -0.17610760033130646, 1.4737188816070557, 0.273185133934021, 1.5707963705062866, -1.0363900661468506], [0.6458536386489868, -0.27062395215034485, 1.6009212732315063, 0.24049901962280273, 1.5707963705062866, -0.9249427318572998], [0.6901171207427979, -0.390178918838501, 1.7995128631591797, 0.1614624261856079, 1.5707963705062866, -0.8806792497634888], [0.6289960145950317, -0.4910987317562103, 2.0167789459228516, 0.04511618614196777, 1.5707963705062866, -0.9418003559112549], [0.8049951791763306, -0.45031866431236267, 2.049692153930664, -0.028577089309692383, 1.5707963705062866, -0.765801191329956], [0.9600093364715576, -0.5815020203590393, 2.12030029296875, 0.0319981575012207, 1.5707963705062866, -0.610787034034729], [0.9670486450195312, -0.7656906843185425, 2.1454291343688965, 0.19105792045593262, 1.5707963705062866, -0.6037477850914001], [0.953545093536377, -0.9584964513778687, 2.277620792388916, 0.25167202949523926, 1.5707963705062866, -0.6172512769699097], [1.149499773979187, -1.056994080543518, 2.209317445755005, 0.4184730052947998, 1.5707963705062866, -0.4212965965270996], [1.3510836362838745, -1.1352195739746094, 2.1987428665161133, 0.5072731971740723, 1.5707963705062866, -0.2197127342224121], [1.5670065879821777, -1.1687703132629395, 2.2034037113189697, 0.5361630916595459, 1.5707963705062866, -0.0037897825241088867], [1.7059128284454346, -1.2707587480545044, 2.303577184677124, 0.537977933883667, 1.5707963705062866, 0.13511645793914795], [1.6670594215393066, -1.4706764221191406, 2.2889108657836914, 0.7525620460510254, 1.5707963705062866, 0.09626305103302002], [1.7251126766204834, -1.6704343557357788, 2.3211355209350586, 0.9200952053070068, 1.5707963705062866, 0.15431630611419678], [1.9486265182495117, -1.5478161573410034, 2.127150058746338, 0.9914624691009521, 1.570796251296997, 0.3778301477432251], [1.9986491203308105, -1.3844501972198486, 1.9409728050231934, 1.0142736434936523, 1.570796251296997, 0.4278527498245239], [2.043255090713501, -1.1214340925216675, 1.9366695880889893, 0.7555608749389648, 1.570796251296997, 0.47245872020721436]]
# trajectory =[[0.3440885841846466, 0.05174235254526138, 1.147074818611145, 0.3719792366027832, 1.5707963705062866, -1.2267078161239624], [0.21900805830955505, 0.037563152611255646, 1.3014206886291504, 0.2318124771118164, 1.5707963705062866, -1.3517882823944092], [0.13340461254119873, -0.05149191990494728, 1.5524674654006958, 0.06982088088989258, 1.5707963705062866, -1.437391757965088], [0.10297146439552307, -0.0028850266244262457, 1.6808878183364868, -0.10720646381378174, 1.5707963705062866, -1.467824935913086], [0.02030932903289795, -0.06840970367193222, 1.904752254486084, -0.26554620265960693, 1.5707963705062866, -1.5504870414733887], [0.003654003143310547, -0.14220716059207916, 2.1086506843566895, -0.39564716815948486, 1.5707963705062866, -1.567142367362976], [0.24028807878494263, -0.07028114795684814, 2.115777015686035, -0.4746994972229004, 1.5707963705062866, -1.3305083513259888], [0.46789705753326416, -0.23743565380573273, 2.2043442726135254, -0.39611220359802246, 1.5707963705062866, -1.1028993129730225], [0.7195720076560974, -0.23140732944011688, 2.268937826156616, -0.4667341709136963, 1.5707963705062866, -0.8512243628501892], [0.8085436224937439, -0.07560606300830841, 2.300243616104126, -0.6538411378860474, 1.5707963705062866, -0.7622527480125427], [0.7626301050186157, -0.09908542037010193, 2.488558769226074, -0.8186769485473633, 1.5707963705062866, -0.8081662654876709], [1.251110315322876, -0.4318059980869293, 2.4841675758361816, -0.4815652370452881, 1.5707963705062866, -0.31968605518341064], [1.455911636352539, -0.6880591511726379, 2.4302971363067627, -0.17144155502319336, 1.5707963705062866, -0.11488473415374756], [1.5790011882781982, -0.9294466972351074, 2.471022605895996, 0.0292205810546875, 1.5707963705062866, 0.008204817771911621], [1.9255708456039429, -0.9133065342903137, 2.399618625640869, 0.08448433876037598, 1.570796251296997, 0.35477447509765625], [1.9810988903045654, -0.9610227942466736, 2.2289795875549316, 0.3028395175933838, 1.570796251296997, 0.4103025197982788], [2.062107801437378, -0.9151825904846191, 2.0264906883239746, 0.4594883918762207, 1.570796251296997, 0.4913114309310913], [1.9449599981307983, -0.9982354640960693, 1.9790751934051514, 0.589956521987915, 1.570796251296997, 0.3741636276245117], [1.873112678527832, -1.1481516361236572, 1.9896200895309448, 0.7293277978897095, 1.570796251296997, 0.3023163080215454], [1.99616539478302, -1.2225772142410278, 1.9190576076507568, 0.8743159770965576, 1.570796251296997, 0.4253690242767334], [2.043255090713501, -1.1214340925216675, 1.9366695880889893, 0.7555608749389648, 1.570796251296997, 0.47245872020721436]]





# 可选的循环播放开关
loop_playback = True  # True 为循环播放，False 为单次播放

# 主函数
def publish_trajectory():
    rospy.loginfo("Publishing joint trajectory...")
    while not rospy.is_shutdown():
        for joint_angles in trajectory:
            joint_state = JointState()
            joint_state.header.stamp = rospy.Time.now()
            joint_state.name = [
                "shoulder_pan_joint", "shoulder_lift_joint", "elbow_joint",
                "wrist_1_joint", "wrist_2_joint", "wrist_3_joint"
            ]
            
            for joint in joint_angles:
                print('joint', joint)
                joint = float(joint)
            joint_state.position = joint_angles  # 设置当前的关节角度
            joint_pub.publish(joint_state)  # 发布关节状态
            rate.sleep()  # 等待一段时间

        # 检查是否需要继续播放
        if not loop_playback:
            rospy.loginfo("Trajectory playback complete.")
            break  # 退出循环播放

# 启动发布器
if __name__ == "__main__":
    try:
        publish_trajectory()
    except rospy.ROSInterruptException:
        rospy.loginfo("Trajectory playback interrupted.")